<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>ページ表示時のイベントの順番</title>

</head>

<body>

<h1>ページ表示時のイベントの順番</h1>

<ul>
  <li>DOMContentLoaded</li>
  <li>load</li>
  <li>onpageshow</li>
  <li>readystatechange</li>
</ul>

<textarea style="width: 640px; height: 320px; font-size: 20px;line-height: 2em; padding: 16px;"></textarea>


<h2>画像</h2>

<img style="width: 320px; height: auto;" src="img.jpg" alt="画像">


<script>
const log = document.querySelector('textarea');
const img = document.querySelector('img');

log.textContent = '';

window.addEventListener('pageshow', (e) => {
  // ページをキャッシュから読み込んだか、直接読み込んだかを返す
  const cache = event.persisted ? "cache" : "not cache";
  log.textContent = log.textContent + 'pageshow(' + cache + ')\n';
});

document.addEventListener('DOMContentLoaded', () => {
  log.textContent = log.textContent + 'DOMContentLoaded\n';
});

window.addEventListener('load', () => {
  log.textContent = log.textContent + 'window load\n';
});

img.addEventListener('load', () => {
  log.textContent = log.textContent + 'img load\n';
});

document.addEventListener('readystatechange', () => {
  log.textContent = log.textContent + 'readystatechange : ' + document.readyState + '\n';
});
</script>

</body>
</html>
